;-------------------------------------------------
;メガネなどその他小物の関数
;EQUIP:악세사리でビット管理する
;他のものと異なり記号的な意味が非常に強い
;-------------------------------------------------
@SET_OTHER, ARG, ARG:1
TCVAR:ARG:26 = 0

IF ARG:1 == 0
	EQUIP:ARG:악세사리 = 0
	CSTR:ARG:49 = 
	RETURN 0
ENDIF

;名前記録
CSTR:ARG:49 = %PALAM_OTHER(ARG:1, ARG, 1)%

TCVAR:ARG:26 = 0
RETURN ARG:1
;-------------------------------------------------
;ARGの身につけている小物の名前. ARG:1==0なら正式名称 by CSTR. ARG:1==1なら短縮名称 by EQUIP. 
;-------------------------------------------------
@OTHER(ARG, ARG:1)
#FUNCTIONS
SELECTCASE ARG:1
CASE 0
	LOCALS = %CSTR:ARG:49%
CASE 1
	LOCALS = %CSTR:ARG:49%
ENDSELECT
RETURNF LOCALS

;-------------------------------------------------
;ARG番の小物の正式名称
;ARG:1 > 0ならARG:1は캐릭터번호として働く
;-------------------------------------------------
@NAME_OTHER(ARG, ARG:1)
#FUNCTIONS
LOCALS = %PALAM_OTHER(ARG, ARG:1)%
RETURNF LOCALS

;-------------------------------------------------
;ARG番の小物の詳細パラ
;ARG:1 > 0ならARG:1は캐릭터번호として働き, ARG:1 > 0 && ARG:2 > 0ならEQUIPを定める
;-------------------------------------------------
@PALAM_OTHER(ARG, ARG:1, ARG:2)
#FUNCTIONS
VARSET LOCAL
VARSET LOCALS

SELECTCASE ARG
CASE 1, 38, 39, 40
	LOCAL = SETFLAG_OTHER("쵸커")
	LOCALS = 쵸커\/\/\/\/
CASE 2
	LOCAL = SETFLAG_OTHER("카츄샤")
	LOCALS = \/\/\/카츄샤\/
CASE 3
	;LOCAL = SETFLAG_OTHER("꽃머리장식", "캣가터")
	;LOCALS = \/\/\/草꽃머리장식\/정애の宿목
	LOCAL = SETFLAG_OTHER("꽃머리장식")
	LOCALS = \/\/\/草꽃머리장식\/
CASE 4
	IF CFLAG:(ARG:1):8 == 2
		LOCAL = SETFLAG_OTHER("프릴쵸커", "시뇽캡")
		LOCALS = 프릴쵸커\/\/\/시뇽캡\/
	ELSE
		LOCAL = SETFLAG_OTHER("프릴쵸커", "리본")
		LOCALS = 프릴쵸커\/\/\/요정の리본\/
	ENDIF
CASE 6
	LOCAL = SETFLAG_OTHER("방울쵸커")
	LOCALS = 방울쵸커\/\/\/\/
CASE 7
	LOCAL = SETFLAG_OTHER("가시달린가죽목걸이")
	LOCALS = 犬の개목걸이\/\/\/\/
CASE 8, 9
	IF CFLAG:(ARG:1):8 == 2
		LOCAL = SETFLAG_OTHER("")
		LOCALS = \/\/\/\/
	ELSEIF CFLAG:(ARG:1):8 == 4
		LOCAL = SETFLAG_OTHER("리본쵸커")
		LOCALS = 리본쵸커\/\/\/\/
	ELSE
		LOCAL = SETFLAG_OTHER("리본쵸커", "리본")
		LOCALS = 리본쵸커\/\/\/可愛い리본\/
	ENDIF
CASE 10
	IF CFLAG:(ARG:1):8 == 2
		LOCAL = SETFLAG_OTHER("프릴쵸커", "헤드드레스")
		LOCALS = 프릴쵸커\/\/\/헤드드레스\/
	ELSE
		LOCAL = SETFLAG_OTHER("린グ쵸커", "서클릿")
		LOCALS = 링쵸커\/\/\/娼蛇の티아라\/
	ENDIF
CASE 11
	IF CFLAG:(ARG:1):8 == 2
		LOCAL = SETFLAG_OTHER("세라캡")
		LOCALS = \/\/\/세라캡\/
	ENDIF
CASE 14
	LOCAL = SETFLAG_OTHER("린グ쵸커", "티아라")
	LOCALS = 링쵸커\/\/\/티아라\/
CASE 15
	IF CFLAG:(ARG:1):8 == 2
		LOCAL = SETFLAG_OTHER("마녀모자")
		LOCALS = \/\/\/クロブーク\/
	ELSE
		LOCAL = SETFLAG_OTHER("꽃머리장식")
		LOCALS = \/\/\/꽃머리장식\/
	ENDIF
CASE 16
	IF CFLAG:(ARG:1):8 == 2
		;LOCAL = SETFLAG_OTHER("시뇽캡", "캣가터")
		;LOCALS = \/\/\/시뇽캡\/濡れて剥がれた御札
		LOCAL = SETFLAG_OTHER("시뇽캡")
		LOCALS = \/\/\/시뇽캡\/
	ELSEIF CFLAG:(ARG:1):8 == 3
		;LOCAL = SETFLAG_OTHER("비녀", "캣가터")
		;LOCALS = \/\/\/비녀\/濡れて剥がれた御札
		LOCAL = SETFLAG_OTHER("비녀")
		LOCALS = \/\/\/비녀\/
	ELSE
		;LOCAL = SETFLAG_OTHER("캣가터")
		;LOCALS = \/\/\/\/濡れて剥がれた御札
	ENDIF
CASE 17
	IF CFLAG:(ARG:1):8 == 1
		LOCAL = SETFLAG_OTHER("실크햇")
		LOCALS = \/\/실크햇\/\/
	ELSE
		LOCAL = SETFLAG_OTHER("가시달린가죽목걸이")
		LOCALS = 가시달린가죽목걸이\/\/\/\/
	ENDIF
CASE 18
	LOCAL = SETFLAG_OTHER("레이스쵸커", "비녀")
	LOCALS = 레이스쵸커\/\/\/비녀\/
CASE 19, 47
	LOCAL = SETFLAG_OTHER("쵸커", "마녀모자")
	LOCALS = 쵸커\/\/마녀모자\/\/
CASE 20, 21
	LOCAL = SETFLAG_OTHER("끈쵸커")
	LOCALS = 끈쵸커\/\/\/\/
CASE 22
	LOCAL = SETFLAG_OTHER("하치가네")
	LOCALS = \/\/\/하치가네\/
CASE 23, 33, 58
	LOCAL = SETFLAG_OTHER("넥타이", "실크햇")
	LOCALS = 気取った蝶넥타이\/\/お洒落な실크햇\/\/
CASE 24, 26
	LOCAL = SETFLAG_OTHER("카츄샤")
	LOCALS = \/\/\/카츄샤\/
CASE 25
	LOCAL = SETFLAG_OTHER("모피머플러", "헤드드레스", "マント")
	LOCALS = 밤魔の襟巻き\/\/\/헤드드레스\/常밤の外套
CASE 27
	LOCAL = SETFLAG_OTHER("헤드드레스")
	LOCALS = \/\/\/헤드드레스\/
CASE 28
	LOCAL = SETFLAG_OTHER("가죽쵸커", "하치가네")
	LOCALS = 가죽쵸커\/\/\/하치가네\/
CASE 29
	;LOCAL = SETFLAG_OTHER("캣가터")
	;LOCALS = \/\/\/\/미니チュア슬라임
CASE 30
	LOCAL = SETFLAG_OTHER("레이스쵸커", "꽃머리장식")
	LOCALS = 레이스쵸커\/\/\/꽃머리장식\/
CASE 31
	;LOCAL = SETFLAG_OTHER("가시달린가죽목걸이", "서클릿", "캣가터")
	;LOCALS = 가시달린가죽목걸이\/\/\/仔오니の帽子\/仔오니の도구袋
	LOCAL = SETFLAG_OTHER("가시달린가죽목걸이", "서클릿")
	LOCALS = 가시달린가죽목걸이\/\/\/仔오니の帽子\/
CASE 33
	;LOCAL = SETFLAG_OTHER("캣가터")
	;LOCALS = \/\/\/\/大食いな宝箱
CASE 34
	LOCAL = SETFLAG_OTHER("보석머리장식")
	LOCALS = \/\/\/結晶の冠\/
CASE 35
	LOCAL = SETFLAG_OTHER("끈쵸커", "베레모")
	LOCALS = 끈쵸커\/\/お洒落な帽子\/\/
CASE 41
	LOCAL = SETFLAG_OTHER("가시달린가죽목걸이")
	LOCALS = 가시달린가죽목걸이\/\/\/\/
CASE 42
	IF CFLAG:(ARG:1):209 == 1
		LOCAL = SETFLAG_OTHER("쵸커")
		LOCALS = 쵸커\/\/\/\/
	ENDIF
CASE 46
	LOCAL = SETFLAG_OTHER("프릴쵸커", "카츄샤")
	LOCALS = 프릴쵸커\/\/\/카츄샤\/
CASE 48
	;ヴェールは帽子…？保留
	;LOCAL = SETFLAG_OTHER("캣가터")
	;LOCALS = \/\/\/\/밤のヴェール
CASE 49
	LOCAL = SETFLAG_OTHER("왕관")
	LOCALS = \/\/\/왕관\/
CASE 50
	LOCAL = SETFLAG_OTHER("프릴쵸커", "리본")
	LOCALS = 프릴쵸커\/\/\/리본\/
CASE 54
	LOCAL = SETFLAG_OTHER("안경", "마녀모자")
	LOCALS = \/司書の안경\/\/司書の帽子\/
CASE 55
	LOCAL = SETFLAG_OTHER("리본")
	LOCALS = \/\/\/真っ빨강な리본\/
CASE 57
	LOCAL = SETFLAG_OTHER("꽃머리장식")
	LOCALS = \/\/\/진홍の머리카락飾り\/
CASE 60
	LOCAL = SETFLAG_OTHER("모피머플러")
	LOCALS = 모피머플러\/\/\/\/
CASE 100
	LOCAL = SETFLAG_OTHER("쵸커")
	LOCALS:10 = 쵸커
CASE 101
	LOCAL = SETFLAG_OTHER("레이스쵸커")
	LOCALS:10 = 레이스쵸커
CASE 102
	LOCAL = SETFLAG_OTHER("프릴쵸커")
	LOCALS:10 = 프릴쵸커
CASE 103
	LOCAL = SETFLAG_OTHER("리본쵸커")
	LOCALS:10 = 리본쵸커
CASE 104
	LOCAL = SETFLAG_OTHER("끈쵸커")
	LOCALS:10 = 끈쵸커
CASE 105
	LOCAL = SETFLAG_OTHER("가죽쵸커")
	LOCALS:10 = 가죽쵸커
CASE 106
	LOCAL = SETFLAG_OTHER("방울쵸커")
	LOCALS:10 = 방울쵸커
CASE 107
	LOCAL = SETFLAG_OTHER("린グ쵸커")
	LOCALS:10 = 링쵸커
CASE 108
	LOCAL = SETFLAG_OTHER("가시달린가죽목걸이")
	LOCALS:10 = 가시달린가죽목걸이
CASE 109
	LOCAL = SETFLAG_OTHER("모피머플러")
	LOCALS:10 = 모피머플러
CASE 110
	LOCAL = SETFLAG_OTHER("넥타이")
	LOCALS:10 = 넥타이

CASE 120
	LOCAL = SETFLAG_OTHER("안경")
	LOCALS:11 = 안경

CASE 125
	LOCAL = SETFLAG_OTHER("실크햇")
	LOCALS:12 = 실크햇
CASE 126
	LOCAL = SETFLAG_OTHER("마녀모자")
	LOCALS:12 = 마녀모자
CASE 127
	LOCAL = SETFLAG_OTHER("베레모")
	LOCALS:12 = 베레모

CASE 130
	LOCAL = SETFLAG_OTHER("고양이귀")
	LOCALS:12 = 고양이귀
CASE 131
	LOCAL = SETFLAG_OTHER("토끼귀")
	LOCALS:12 = 토끼귀
CASE 132
	LOCAL = SETFLAG_OTHER("여우귀")
	LOCALS:12 = 여우귀
CASE 133
	LOCAL = SETFLAG_OTHER("강아지귀")
	LOCALS:12 = 강아지귀

CASE 140
	LOCAL = SETFLAG_OTHER("카츄샤")
	LOCALS:13 = 카츄샤
CASE 141
	LOCAL = SETFLAG_OTHER("리본")
	LOCALS:13 = 리본
CASE 142
	LOCAL = SETFLAG_OTHER("서클릿")
	LOCALS:13 = 서클릿
CASE 143
	LOCAL = SETFLAG_OTHER("티아라")
	LOCALS:13 = 티아라
CASE 144
	LOCAL = SETFLAG_OTHER("비녀")
	LOCALS:13 = 비녀
CASE 145
	LOCAL = SETFLAG_OTHER("시뇽캡")
	LOCALS:13 = 시뇽캡
CASE 146
	LOCAL = SETFLAG_OTHER("꽃머리장식")
	LOCALS:13 = 꽃머리장식
CASE 147
	LOCAL = SETFLAG_OTHER("보석머리장식")
	LOCALS:13 = 보석머리장식
CASE 148
	LOCAL = SETFLAG_OTHER("헤드드레스")
	LOCALS:13 = 헤드드레스
CASE 149
	LOCAL = SETFLAG_OTHER("왕관")
	LOCALS:13 = 왕관
CASE 150
	LOCAL = SETFLAG_OTHER("하치가네")
	LOCALS:13 = 하치가네

CASE 155
	LOCAL = SETFLAG_OTHER("캣가터")
	LOCALS:14 = 캣가터
CASE 156
	LOCAL = SETFLAG_OTHER("マント")
	LOCALS:14 = マント
ENDSELECT

IF ARG:1 > 0 && ARG:2 > 0
	SELECTCASE ARG
	CASE IS < 100
		EQUIP:(ARG:1):악세사리 = LOCAL
	CASEELSE
		SPLIT CSTR:(ARG:1):49, "/", LOCALS
		;今装備しているものと選んだものが同じ場合には外す処理
		IF (LOCAL&EQUIP:(ARG:1):악세사리) == LOCAL
			EQUIP:(ARG:1):악세사리 -= LOCAL
			IF LOCALS:10 != ""
				LOCALS:0 = 
			ELSEIF LOCALS:11 != ""
				LOCALS:1 = 
			ELSEIF LOCALS:12 != ""
				LOCALS:2 = 
			ELSEIF LOCALS:13 != ""
				LOCALS:3 = 
			ELSEIF LOCALS:14 != ""
				LOCALS:4 = 
			ENDIF
		ELSE
			IF LOCALS:10 != ""
				EQUIP:(ARG:1):악세사리 = CLEARBITS(EQUIP:(ARG:1):악세사리, 0, 19)
				LOCALS:0 = %LOCALS:10%
			ELSEIF LOCALS:11 != ""
				EQUIP:(ARG:1):악세사리 = CLEARBITS(EQUIP:(ARG:1):악세사리, 20, 24)
				LOCALS:1 = %LOCALS:11%
			ELSEIF LOCALS:12 != ""
				EQUIP:(ARG:1):악세사리 = CLEARBITS(EQUIP:(ARG:1):악세사리, 25, 39)
				LOCALS:2 = %LOCALS:12%
			ELSEIF LOCALS:13 != ""
				EQUIP:(ARG:1):악세사리 = CLEARBITS(EQUIP:(ARG:1):악세사리, 40, 54)
				LOCALS:3 = %LOCALS:13%
			ELSEIF LOCALS:14 != ""
				EQUIP:(ARG:1):악세사리 = CLEARBITS(EQUIP:(ARG:1):악세사리, 55, 63)
				LOCALS:4 = %LOCALS:14%
			ENDIF
			EQUIP:(ARG:1):악세사리 |= LOCAL
		ENDIF
		LOCALS = %LOCALS:0%\/%LOCALS:1%\/%LOCALS:2%\/%LOCALS:3%\/%LOCALS:4%
	ENDSELECT
ENDIF

SIF LOCALS == ""
	LOCALS = %LOCALS:10%%LOCALS:11%%LOCALS:12%%LOCALS:13%%LOCALS:14%

RETURNF LOCALS

;-------------------------------------------------
;지시されたとおりの小物の플래그を설정するために使う
;-------------------------------------------------
@SETFLAG_OTHER(ARGS:1, ARGS:2, ARGS:3, ARGS:4, ARGS:5, ARGS:6, ARGS:7, ARGS:8, ARGS:9, ARGS:10)
#FUNCTION
#DIM LCOUNT

LOCAL = 0
FOR LCOUNT, 1, 11
	ARGS = %ARGS:LCOUNT%
	SELECTCASE ARGS
	;0bit～19bitは首周り
	CASE "쵸커"
		SETBIT LOCAL, 0
	CASE "레이스쵸커"
		SETBIT LOCAL, 1
	CASE "프릴쵸커"
		SETBIT LOCAL, 2
	CASE "리본쵸커"
		SETBIT LOCAL, 3
	CASE "끈쵸커"
		SETBIT LOCAL, 4
	CASE "가죽쵸커"
		SETBIT LOCAL, 5
	CASE "방울쵸커"
		SETBIT LOCAL, 6
	CASE "린グ쵸커"
		SETBIT LOCAL, 7
	CASE "가시달린가죽목걸이"
		SETBIT LOCAL, 8
	CASE "모피머플러"
		SETBIT LOCAL, 9
	CASE "넥타이"
		SETBIT LOCAL, 10

	;20bit～24bitはメガネなど얼굴につけるもの
	CASE "안경", "メガネ"
		SETBIT LOCAL, 20

	;25bit～39bitは帽子や付け耳など
	CASE "실크햇"
		SETBIT LOCAL, 25
	CASE "마녀모자"
		SETBIT LOCAL, 26
	CASE "베레모"
		SETBIT LOCAL, 27
	CASE "세라캡"
		SETBIT LOCAL, 28

	CASE "고양이귀"
		SETBIT LOCAL, 30
	CASE "토끼귀"
		SETBIT LOCAL, 31
	CASE "여우귀"
		SETBIT LOCAL, 32
	CASE "강아지귀"
		SETBIT LOCAL, 33

	;40bit～54bitは머리카락飾り
	CASE "카츄샤"
		SETBIT LOCAL, 40
	CASE "리본"
		SETBIT LOCAL, 41
	CASE "서클릿"
		SETBIT LOCAL, 42
	CASE "티아라"
		SETBIT LOCAL, 43
	CASE "비녀"
		SETBIT LOCAL, 44
	CASE "시뇽캡"
		SETBIT LOCAL, 45
	CASE "꽃머리장식"
		SETBIT LOCAL, 46
	CASE "보석머리장식"
		SETBIT LOCAL, 47
	CASE "헤드드레스"
		SETBIT LOCAL, 48
	CASE "왕관"
		SETBIT LOCAL, 49
	CASE "하치가네"
		SETBIT LOCAL, 50

	;55bit～はその他
	CASE "캣가터"
		SETBIT LOCAL, 55
	CASE "マント"
		SETBIT LOCAL, 56
	ENDSELECT
	SIF STRLENS(ARGS:(LCOUNT + 1) ) == 0
		RETURNF LOCAL
NEXT
RETURNF LOCAL

;-------------------------------------------------
;ARGの身につけている小物が条件ARGSを満たすか確認する
;-------------------------------------------------
@CHECK_OTHER(ARGS, ARG)
#FUNCTION
SIF ARG == 0 && TARGET
	ARG = TARGET
SIF EQUIP:ARG:악세사리 == 0
	RETURNF 0
SELECTCASE ARGS
CASE "首周り"
	SIF GETBITS(EQUIP:ARG:악세사리, 0, 19)
		RETURNF 1
CASE "안경等"
	SIF GETBITS(EQUIP:ARG:악세사리, 20, 24)
		RETURNF 1
CASE "帽子"
	SIF GETBITS(EQUIP:ARG:악세사리, 25, 39)
		RETURNF 1
CASE "머리카락飾り"
	SIF GETBITS(EQUIP:ARG:악세사리, 40, 54)
		RETURNF 1
CASE "その他装飾具"
	SIF GETBITS(EQUIP:ARG:악세사리, 55, 63)
		RETURNF 1
CASEELSE
	SIF (SETFLAG_OTHER(ARGS)&EQUIP:ARG:악세사리) == SETFLAG_OTHER(ARGS)
		RETURNF 1
ENDSELECT
RETURNF 0

